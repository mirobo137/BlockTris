/* Archivo para los estilos específicos del Modo Niveles */

/* ---- MEJORAS PARA NAVEGACIÓN MÓVIL ---- */

/* Personalizar scrollbar para navegadores webkit */
#level-selection-screen::-webkit-scrollbar {
  width: 8px;
}

#level-selection-screen::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.1);
  border-radius: 4px;
}

#level-selection-screen::-webkit-scrollbar-thumb {
  background: rgba(255, 235, 59, 0.6);
  border-radius: 4px;
}

#level-selection-screen::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 235, 59, 0.8);
}

/* Indicador visual de scroll para móviles */
@media (max-width: 768px) {
  #level-selection-screen::before {
    content: "⬇️ Desliza para ver más niveles ⬇️";
    position: sticky;
    top: 80px;
    display: block;
    background: rgba(0, 0, 0, 0.7);
    color: #FFEB3B;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9em;
    margin: 10px auto;
    width: fit-content;
    z-index: 99;
    animation: pulseScroll 2s infinite;
  }
}

@keyframes pulseScroll {
  0%, 100% { opacity: 0.7; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

/* Ocultar indicador después del primer scroll */
#level-selection-screen.scrolled::before {
  display: none;
}

/* Estilos específicos para vista móvil */
#level-selection-screen.mobile-view {
  padding: 10px;
}

#level-selection-screen.mobile-view h2 {
  font-size: 1.8em;
  padding: 8px 0;
  margin: 5px 0 15px 0;
}

/* Mejorar área de toque para botones en móviles */
@media (max-width: 768px) {
  .level-card:active {
    transform: scale(0.95);
    box-shadow: 0 3px 8px rgba(0,0,0,0.4);
  }
  
  /* Añadir espacio entre elementos para mejor navegación */
  .level-stars {
    margin: 10px 0;
  }
  
  .level-objective {
    font-size: 0.85em;
    line-height: 1.3;
    padding: 5px 0;
  }
  
  .level-number {
    font-size: 2.2em;
  }
}

/* Animación suave para cambios de layout */
.level-card, #levels-grid {
  transition: all 0.3s ease;
}

#level-selection-screen {
  width: 100%;
  height: 100vh; /* Altura completa de la pantalla */
  overflow-y: auto; /* Permitir scroll vertical */
  overflow-x: hidden; /* Evitar scroll horizontal */
  padding: 20px;
  box-sizing: border-box;
  text-align: center;
  /* Scroll suave en móviles */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Contenedor interno para centrar contenido y limitar ancho máximo */
#level-selection-screen .levels-container {
  max-width: 900px;
  margin: 0 auto;
  padding-bottom: 80px; /* Espacio extra al final para mejor navegación */
}

#level-selection-screen h2 {
  font-size: 2.5em;
  color: #FFEB3B; /* Amarillo */
  text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
  margin: 20px 0 30px 0;
  position: sticky; /* Mantener título visible al hacer scroll */
  top: 0;
  background: linear-gradient(to bottom, rgba(109, 91, 151, 0.95), rgba(109, 91, 151, 0.8));
  padding: 15px 0;
  z-index: 100;
  backdrop-filter: blur(5px); /* Efecto de desenfoque de fondo */
}

/* Responsive para móviles */
@media (max-width: 768px) {
  #level-selection-screen h2 {
    font-size: 2em;
    margin: 10px 0 20px 0;
    padding: 10px 0;
  }
}

#levels-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); /* Cuadrícula responsiva */
  gap: 25px;
  margin-bottom: 30px;
  padding: 0 10px; /* Padding lateral para móviles */
}

/* Responsive para diferentes tamaños de pantalla */
@media (max-width: 480px) {
  #levels-grid {
    grid-template-columns: 1fr; /* Una sola columna en móviles pequeños */
    gap: 20px;
    padding: 0 5px;
  }
}

@media (min-width: 481px) and (max-width: 768px) {
  #levels-grid {
    grid-template-columns: repeat(2, 1fr); /* Dos columnas en tablets */
    gap: 20px;
  }
}

@media (min-width: 769px) and (max-width: 1024px) {
  #levels-grid {
    grid-template-columns: repeat(3, 1fr); /* Tres columnas en tablets grandes */
  }
}

@media (min-width: 1025px) {
  #levels-grid {
    grid-template-columns: repeat(4, 1fr); /* Cuatro columnas en desktop */
  }
}

.level-card {
  background: linear-gradient(to bottom right, #524079, #775a8a); /* Mismo degradado que modal */
  border-radius: 12px;
  padding: 20px;
  color: #fff;
  text-align: center;
  box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between; /* Para espaciar contenido interno */
  min-height: 200px; /* Altura mínima para consistencia */
  /* Mejorar interacción táctil */
  touch-action: manipulation;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* Responsive para móviles */
@media (max-width: 768px) {
  .level-card {
    min-height: 180px;
    padding: 15px;
    border-radius: 10px;
  }
}

@media (max-width: 480px) {
  .level-card {
    min-height: 160px;
    padding: 12px;
    margin: 0 auto;
    max-width: 300px; /* Limitar ancho máximo en móviles pequeños */
  }
}

.level-card:not(.locked):hover {
  transform: translateY(-5px) scale(1.03);
  box-shadow: 0 10px 20px rgba(0,0,0,0.4);
}

.level-number {
  font-size: 2.8em;
  font-weight: bold;
  color: #FFEB3B;
  margin-bottom: 10px;
  line-height: 1;
}

.level-stars {
  margin-bottom: 15px;
  font-size: 1.8em; /* Tamaño de las estrellas */
  line-height: 1;
}

.star {
  display: inline-block; /* Para que se alineen */
  color: #555; /* Color de estrella vacía (gris oscuro) */
  margin: 0 2px;
}

.star.filled {
  color: #FFD700; /* Color de estrella llena (dorado) */
}

/* Ejemplo de cómo se verían con pseudo-elementos */
.star::before {
  content: "\2606"; /* Estrella vacía (puedes usar \2605 para llena) */
}

.star.filled::before {
  content: "\2605"; /* Estrella llena */
}

.level-objective {
  font-size: 0.9em;
  color: #e0e0e0;
  margin-top: auto; /* Empuja el objetivo hacia abajo si hay espacio extra */
}

.level-card.locked {
  background: linear-gradient(to bottom right, #4a4a4a, #616161); /* Fondo grisáceo para bloqueados */
  cursor: not-allowed;
  opacity: 0.7;
}

.lock-icon {
  font-size: 3em;
  color: rgba(255,255,255,0.5);
  margin-top: 10px;
}

#backToModeSelectionFromLevelsButton {
    margin: 20px auto 40px auto; /* Espacio arriba y abajo del botón de volver */
    padding: 12px 24px;
    font-size: 1.1em;
    min-height: 48px; /* Altura mínima para fácil toque en móviles */
    touch-action: manipulation;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}

/* Responsive para móviles */
@media (max-width: 768px) {
  #backToModeSelectionFromLevelsButton {
    width: 90%;
    max-width: 300px;
    margin: 30px auto 60px auto;
    font-size: 1em;
  }
}

/* ---- MODAL DE OBJETIVO INICIAL ---- */
#levelObjectiveStartModal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000; /* Por encima de todo */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
}

#levelObjectiveStartModal.visible {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease;
}

#levelObjectiveStartModal .modal-content {
    background: linear-gradient(to bottom right, #4b3f70, #6a5a8a);
    padding: 25px 35px;
    border-radius: 12px;
    box-shadow: 0 7px 25px rgba(0,0,0,0.4);
    text-align: center;
    color: #f0f0f0;
    transform: scale(0.95);
    transition: transform 0.3s ease-out;
    max-width: 500px;
    width: 90%;
}

#levelObjectiveStartModal.visible .modal-content {
    transform: scale(1);
}

#levelObjectiveStartModal h2 {
    margin-top: 0;
    color: #FFEB3B;
    font-size: 1.9em;
    margin-bottom: 15px;
}

#levelObjectiveStartModal p {
    font-size: 1.15em;
    line-height: 1.5;
    margin-bottom: 25px;
    color: #d8d8d8;
}

#levelObjectiveStartModal button {
    background-color: #f9ca24; /* Amarillo vibrante */
    color: #333;
    border: none;
    padding: 10px 20px;
    font-size: 1.05em;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.1s ease;
}

#levelObjectiveStartModal button:hover {
    background-color: #f6e58d;
    transform: translateY(-2px);
}

/* ---- REDISEÑO DEL DISPLAY DE INFO PERSISTENTE ---- */
#level-info-display {
    position: static; /* Lo sacamos de absolute para que fluya normalmente */
    transform: none; /* Resetear transform si lo tenía */
    background-color: rgba(0, 0, 0, 0.35); /* Fondo sutil */
    color: white;
    padding: 8px 15px;
    border-radius: 6px;
    font-size: 0.95em; /* Más pequeño */
    z-index: auto; /* No necesita z-index alto ahora */
    box-shadow: 0 2px 5px rgba(0,0,0,0.25);
    width: auto; /* Ancho basado en contenido */
    max-width: 300px; /* Máximo ancho para que no se desborde */
    text-align: center; 
    margin: 0 auto 15px auto; /* Centrado y con margen inferior antes del tablero */
    /* Ya no es 'absolute', así que 'top' y 'left' no aplican como antes */
    /* Se insertará antes del game-container o donde se decida en el HTML/JS */
}

#level-info-display p {
    margin: 2px 0; /* Reducir margen entre párrafos si hay múltiples */
    font-size: 1em; /* Ajustar si es necesario */
}

#level-info-display .info-label {
    font-weight: bold;
    color: #FFEB3B; /* Amarillo para las etiquetas */
}

#level-info-display span { /* Para los contadores */
    color: #fff; /* Blanco para los valores */
    font-weight: normal;
}

/* Estilos para el Modal de Victoria de Nivel */

/* Contenedor principal del modal (la superposición) */
#levelVictoryModal {
    position: fixed; /* Clave para superponer */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7); /* Fondo oscuro semitransparente */
    display: flex; /* Para centrar el contenido del modal */
    align-items: center;
    justify-content: center;
    z-index: 2000; /* Debe estar por encima de otros contenidos */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

#levelVictoryModal.visible {
    opacity: 1;
    visibility: visible;
}

/* Contenido del modal (la caja con el mensaje) */
#levelVictoryModal .modal-content {
    background: linear-gradient(to bottom right, #524079, #775a8a); /* Similar al gameOverModal */
    padding: 30px 40px;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.5);
    text-align: center;
    color: #ffffff; 
    transform: scale(0.9);
    transition: transform 0.3s ease-out;
}

#levelVictoryModal.visible .modal-content {
    transform: scale(1);
}

#levelVictoryModal h2 {
    margin-top: 0;
    color: #FFEB3B; /* Amarillo, como otros títulos de modal */
    font-size: 2.5em;
    margin-bottom: 15px;
}

#levelVictoryModal p {
    font-size: 1.2em; /* Ajustar según necesidad */
    margin-bottom: 15px;
}

#levelVictoryModal #levelVictoryMessage {
    font-size: 1.4em;
    font-style: italic;
    margin-bottom: 20px;
}

#levelVictoryModal .stars-container {
    display: flex;
    justify-content: center;
    margin: 20px 0;
}

#levelVictoryModal .stars-container .star {
    font-size: 3em; /* Tamaño de las estrellas */
    color: #777; /* Color de estrella vacía más oscuro que el anterior*/
    margin: 0 8px;
    transition: color 0.3s ease-in-out, transform 0.3s ease-in-out;
}

#levelVictoryModal .stars-container .star.filled {
    color: #ffd700; /* Color de estrella llena (dorado) */
    transform: scale(1.1);
}

#levelVictoryModal .modal-buttons {
    margin-top: 25px;
}

#levelVictoryModal .modal-buttons button {
    /* Heredará los estilos de .btn si los tienes definidos de forma global
       o de .action-button / .secondary-action-button si usas esas clases.
       Si no, define estilos base aquí o usa los de #restartGameButton como referencia */
    padding: 12px 25px;
    font-size: 1.1em;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    margin: 5px;
    border: none;
}

#levelVictoryModal #nextLevelButton {
    background-color: #4CAF50; /* Verde */
    color: white;
}
#levelVictoryModal #nextLevelButton:hover {
    background-color: #45a049;
    transform: translateY(-2px);
}

#levelVictoryModal #levelVictoryBackToSelectionButton {
    background-color: #008CBA; /* Azul */
    color: white;
}

#levelVictoryModal #levelVictoryBackToSelectionButton:hover {
    background-color: #007ba7;
    transform: translateY(-2px);
}

/* Asegúrate que las clases .modal y .hidden estén definidas globalmente (en style.css)
   o defínelas aquí si son específicas para este modal también.
   Por ejemplo:
.modal.hidden {
    display: none !important; 
}
.modal.visible {
    display: flex; 
    opacity: 1; 
    visibility: visible; 
}
*/

/* Estilos para Celdas Congeladas */
.frozen-cell {
    /* Estilo base para cualquier celda congelada, si es necesario */
    /* Podría tener un borde sutil o un efecto general */
    box-shadow: inset 0 0 5px rgba(173, 216, 230, 0.7); /* Sombra interior azul claro como hielo */
}

.frozen-stage-2 { /* Totalmente congelada - Etapa inicial */
    background-color: #ADD8E6; /* Azul claro */
    background-image: repeating-linear-gradient(
        45deg,
        rgba(255, 255, 255, 0.3) 0px,
        rgba(255, 255, 255, 0.3) 3px,
        transparent 3px,
        transparent 6px
    ); /* Rayas diagonales blancas sutiles */
    border: 2px solid #87CEEB; /* Borde azul cielo */
    opacity: 0.9;
}

.frozen-stage-1 { /* Parcialmente descongelada - Lista para destruir */
    background-color: #B0E0E6; /* Azul polvo */
    background-image: repeating-linear-gradient(
        45deg,
        rgba(255, 255, 255, 0.2) 0px,
        rgba(255, 255, 255, 0.2) 2px,
        transparent 2px,
        transparent 4px
    ); /* Rayas más finas o menos opacas */
    border: 1px solid #ADD8E6;
    opacity: 0.75;
}

/* Cuando una celda congelada es parte de la pieza actual que se está colocando,
   no debería tener los estilos de congelamiento, sino el color de la pieza.
   La lógica JS se encargará de esto. */

/* Estilos específicos para el Modal de Game Over en Modo Niveles */
#gameOverModal.levels-game-over-active {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.75); /* Fondo oscuro semitransparente más pronunciado */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2500; /* Muy alto para estar sobre todo, incluso el modal de victoria si es necesario */
    opacity: 0;
    visibility: hidden;
    /* Transiciones ya definidas en #gameOverModal y #gameOverModal.visible, pero podemos asegurar especificidad */
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
}

#gameOverModal.levels-game-over-active.visible {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease;
}

#gameOverModal.levels-game-over-active .modal-content {
    background-color: #4a3f70; /* Tono oscuro púrpura/azul */
    padding: 35px 45px; /* Un poco más de padding */
    border-radius: 15px;
    text-align: center;
    color: #e8e8e8;
    box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    transform: scale(0.9);
    transition: transform 0.3s ease-out;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

#gameOverModal.levels-game-over-active.visible .modal-content {
    transform: scale(1);
}

#gameOverModal.levels-game-over-active h2 {
    color: #ff6b6b; /* Un rojo suave para "Nivel Fallido" */
    margin-top: 0;
    margin-bottom: 18px;
    font-size: 2.4em;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

#gameOverModal.levels-game-over-active p#finalScore { /* Seleccionar el p del puntaje específico */
    margin-bottom: 30px;
    font-size: 1.4em;
    color: #d0d0d0;
}

#gameOverModal.levels-game-over-active button#restartGameButton { /* Estilo específico para el botón en este contexto */
    background-color: #feca57; /* Naranja suave */
    color: #4b390b;
    border: none;
    padding: 14px 30px;
    font-size: 1.15em;
    font-weight: bold;
    border-radius: 10px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.15s ease, box-shadow 0.15s ease;
    box-shadow: 0 5px 12px rgba(0,0,0,0.25);
}

#gameOverModal.levels-game-over-active button#restartGameButton:hover {
    background-color: #ffda79; /* Naranja más claro */
    transform: translateY(-3px);
    box-shadow: 0 7px 15px rgba(0,0,0,0.3);
}

#gameOverModal.levels-game-over-active button#restartGameButton:active {
    transform: translateY(0px);
    background-color: #fdbf43;
}

/* ---- CLASE PARA PREVISUALIZACIÓN DE LÍNEAS COMPLETADAS ---- */
.line-preview-highlight-levels {
    background-color: rgba(144, 238, 144, 0.75) !important; /* Verde claro semitransparente */
    /* Ajusta este color si es necesario */
}

/* ---- ESTILOS PARA PIEZAS DE CEMENTO ---- */
.cement-block {
    background: linear-gradient(135deg, #A0A0A0 0%, #707070 50%, #B8B8B8 100%);
    border: 2px solid #5A5A5A;
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(255,255,255,0.3), inset 0 -2px 4px rgba(0,0,0,0.2);
}

.cement-block::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
        radial-gradient(circle at 20% 20%, rgba(255,255,255,0.5) 1px, transparent 1px),
        radial-gradient(circle at 80% 80%, rgba(255,255,255,0.4) 1px, transparent 1px),
        radial-gradient(circle at 40% 70%, rgba(0,0,0,0.15) 1px, transparent 1px),
        radial-gradient(circle at 60% 30%, rgba(255,255,255,0.3) 1px, transparent 1px);
    background-size: 8px 8px, 12px 12px, 6px 6px, 10px 10px;
    pointer-events: none;
}

.cement-block::after {
    content: '🧱';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.8em;
    opacity: 0.7;
    pointer-events: none;
}

/* Animación de impacto del cemento */
.cement-impact-animation {
    animation: cementImpact 0.5s ease-out;
}

@keyframes cementImpact {
    0% {
        transform: scale(1.3);
        box-shadow: 0 0 20px rgba(105, 105, 105, 0.8);
    }
    50% {
        transform: scale(0.9);
        box-shadow: 0 0 15px rgba(105, 105, 105, 0.6);
    }
    100% {
        transform: scale(1);
        box-shadow: none;
    }
}

/* Efecto de temblor de pantalla */
.screen-shake {
    animation: screenShake 0.3s ease-in-out;
}

@keyframes screenShake {
    0%, 100% { transform: translateX(0); }
    10% { transform: translateX(-2px) translateY(1px); }
    20% { transform: translateX(2px) translateY(-1px); }
    30% { transform: translateX(-1px) translateY(2px); }
    40% { transform: translateX(1px) translateY(-2px); }
    50% { transform: translateX(-2px) translateY(1px); }
    60% { transform: translateX(2px) translateY(-1px); }
    70% { transform: translateX(-1px) translateY(2px); }
    80% { transform: translateX(1px) translateY(-2px); }
    90% { transform: translateX(-1px) translateY(1px); }
}

/* Canvas de animación de cemento */
#cement-animation-canvas {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 1500; /* Por encima del tablero pero debajo de modales */
}

/* ---- ESTILOS PARA ANILLOS DORADOS EN PIEZAS DE SELECCIÓN ---- */
.golden-ring {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 14px !important; /* Más pequeño para las piezas */
    height: 14px !important; /* Más pequeño para las piezas */
    margin: 0 !important;
    padding: 0 !important;
    border: 2px solid transparent;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #FFE55C, #FFD700, #DAA520);
    box-shadow: 
        0 0 8px rgba(255, 215, 0, 0.9),
        inset 0 1px 3px rgba(255, 255, 255, 0.7),
        inset 0 -1px 3px rgba(218, 165, 32, 0.9);
    z-index: 1002 !important;
    pointer-events: none !important;
    user-select: none !important;
    touch-action: none !important;
    animation: pieceRingGlow 2s ease-in-out infinite alternate; /* SOLO BRILLO, SIN ROTACIÓN */
    transform-origin: center;
    box-sizing: border-box !important;
    display: block !important;
}

.golden-ring::before {
    content: '';
    position: absolute;
    top: -1px;
    left: -1px;
    right: -1px;
    bottom: -1px;
    border: 1px solid #FFD700;
    border-radius: 50%;
    background: transparent;
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.8);
    pointer-events: none !important;
    margin: 0 !important;
    padding: 0 !important;
}

.golden-ring::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 5px; /* Más pequeño para las piezas */
    height: 5px; /* Más pequeño para las piezas */
    background: radial-gradient(circle, rgba(255, 255, 255, 0.9), transparent);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* Animación solo de brillo para anillos en piezas de selección */
@keyframes pieceRingGlow {
    0% { 
        box-shadow: 
            0 0 8px rgba(255, 215, 0, 0.9),
            inset 0 1px 3px rgba(255, 255, 255, 0.7),
            inset 0 -1px 3px rgba(218, 165, 32, 0.9);
    }
    100% { 
        box-shadow: 
            0 0 16px rgba(255, 215, 0, 1),
            0 0 24px rgba(255, 215, 0, 0.6),
            inset 0 1px 3px rgba(255, 255, 255, 0.8),
            inset 0 -1px 3px rgba(218, 165, 32, 1);
    }
}

/* ---- ESTILOS PARA ANILLOS EN EL TABLERO ---- */
.board-golden-ring {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 18px !important;
    height: 18px !important;
    margin: 0 !important;
    padding: 0 !important;
    border: 2px solid transparent;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #FFE55C, #FFD700, #DAA520);
    box-shadow: 
        0 0 8px rgba(255, 215, 0, 0.8),
        inset 0 1px 3px rgba(255, 255, 255, 0.6),
        inset 0 -1px 3px rgba(218, 165, 32, 0.8);
    z-index: 1001 !important;
    pointer-events: none !important;
    user-select: none !important;
    touch-action: none !important;
    animation: boardRingRotate 3s linear infinite, boardRingGlow 2s ease-in-out infinite alternate;
    transform-origin: center;
    /* Asegurar que el anillo esté perfectamente centrado */
    display: block !important;
    box-sizing: border-box !important;
}

/* Asegurar que las celdas con anillos mantengan el centrado */
.cell[data-has-ring="true"],
.cell-with-ring {
    position: relative !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    box-sizing: border-box !important;
}

.board-golden-ring::before {
    content: '';
    position: absolute;
    top: -1px;
    left: -1px;
    right: -1px;
    bottom: -1px;
    border: 1px solid #FFD700;
    border-radius: 50%;
    background: transparent;
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.6);
    pointer-events: none !important;
}

.board-golden-ring::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.9), transparent);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none !important;
}

/* Animaciones para anillos en el tablero */
@keyframes boardRingRotate {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(360deg); }
}

@keyframes boardRingGlow {
    0% { 
        box-shadow: 
            0 0 8px rgba(255, 215, 0, 0.8),
            inset 0 1px 3px rgba(255, 255, 255, 0.6),
            inset 0 -1px 3px rgba(218, 165, 32, 0.8);
    }
    100% { 
        box-shadow: 
            0 0 16px rgba(255, 215, 0, 1),
            0 0 24px rgba(255, 215, 0, 0.6),
            inset 0 1px 3px rgba(255, 255, 255, 0.8),
            inset 0 -1px 3px rgba(218, 165, 32, 1);
    }
}

@keyframes ringIndicatorPulse {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
    }
    100% { 
        transform: scale(1.2);
        box-shadow: 0 0 12px rgba(255, 215, 0, 1);
    }
}

/* ... (código existente de celdas congeladas) ... */

/* ---- ESTILOS MEJORADOS PARA ARRASTRE DE PIEZAS ---- */
.piece {
    cursor: grab !important;
    user-select: none !important;
    touch-action: none !important;
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    position: relative !important; /* Importante para el posicionamiento de anillos */
    box-sizing: border-box !important;
    overflow: visible !important; /* Asegurar que los anillos sean visibles */
}

.piece:active {
    cursor: grabbing !important;
}

.piece.dragging {
    cursor: grabbing !important;
    z-index: 9999 !important;
    pointer-events: none !important;
    position: fixed !important;
    overflow: visible !important;
}

.piece .piece-block {
    pointer-events: none !important;
    user-select: none !important;
    box-sizing: border-box !important;
    position: relative !important; /* Para mejor posicionamiento */
}

/* Asegurar que los elementos hijos de las piezas no interfieran */
.piece * {
    pointer-events: none !important;
    user-select: none !important;
    touch-action: none !important;
}

/* Excepción: la pieza padre sí debe recibir eventos */
.piece {
    pointer-events: auto !important;
}

/* Efecto de recolección de anillo */
.ring-collected {
    animation: ringCollected 0.6s ease-out forwards;
}

@keyframes ringCollected {
    0% {
        transform: scale(1) rotateY(0deg);
        opacity: 1;
    }
    50% {
        transform: scale(1.5) rotateY(180deg);
        opacity: 0.8;
    }
    100% {
        transform: scale(2) rotateY(360deg);
        opacity: 0;
    }
}

/* Partículas de anillo */
.ring-particle {
    border-radius: 50%;
    animation: particleFade 1s ease-out forwards;
}

@keyframes particleFade {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    100% {
        opacity: 0;
        transform: scale(0.5);
    }
}

/* Indicador de anillo en pieza - MEJORADO */
.piece-with-ring {
    position: relative !important;
    overflow: visible !important;
}

.piece-with-ring::after {
    content: '';
    position: absolute;
    top: -5px;
    right: -5px;
    width: 12px;
    height: 12px;
    background: radial-gradient(circle, #FFD700, #DAA520);
    border: 1px solid #FFE55C;
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
    animation: ringIndicatorPulse 1s ease-in-out infinite alternate;
    z-index: 1001;
    pointer-events: none !important;
}

/* ---- ESTILOS PARA ANILLOS EN EL TABLERO ---- */
.board-golden-ring {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 18px !important;
    height: 18px !important;
    margin: 0 !important;
    padding: 0 !important;
    border: 2px solid transparent;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #FFE55C, #FFD700, #DAA520);
    box-shadow: 
        0 0 8px rgba(255, 215, 0, 0.8),
        inset 0 1px 3px rgba(255, 255, 255, 0.6),
        inset 0 -1px 3px rgba(218, 165, 32, 0.8);
    z-index: 1001 !important;
    pointer-events: none !important;
    user-select: none !important;
    touch-action: none !important;
    animation: boardRingRotate 3s linear infinite, boardRingGlow 2s ease-in-out infinite alternate;
    transform-origin: center;
    /* Asegurar que el anillo esté perfectamente centrado */
    display: block !important;
    box-sizing: border-box !important;
}

/* Asegurar que las celdas con anillos mantengan el centrado */
.cell[data-has-ring="true"],
.cell-with-ring {
    position: relative !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    box-sizing: border-box !important;
}

.board-golden-ring::before {
    content: '';
    position: absolute;
    top: -1px;
    left: -1px;
    right: -1px;
    bottom: -1px;
    border: 1px solid #FFD700;
    border-radius: 50%;
    background: transparent;
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.6);
    pointer-events: none !important;
}

.board-golden-ring::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.9), transparent);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none !important;
}

/* Animaciones para anillos en el tablero */
@keyframes boardRingRotate {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(360deg); }
}

@keyframes boardRingGlow {
    0% { 
        box-shadow: 
            0 0 8px rgba(255, 215, 0, 0.8),
            inset 0 1px 3px rgba(255, 255, 255, 0.6),
            inset 0 -1px 3px rgba(218, 165, 32, 0.8);
    }
    100% { 
        box-shadow: 
            0 0 16px rgba(255, 215, 0, 1),
            0 0 24px rgba(255, 215, 0, 0.6),
            inset 0 1px 3px rgba(255, 255, 255, 0.8),
            inset 0 -1px 3px rgba(218, 165, 32, 1);
    }
}

@keyframes ringIndicatorPulse {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
    }
    100% { 
        transform: scale(1.2);
        box-shadow: 0 0 12px rgba(255, 215, 0, 1);
    }
}

/* Estilos para efectos de rayos eléctricos - Nivel 5 */

/* Canvas de rayos */
#lightningCanvas {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 1000;
}

/* Celdas electrificadas */
.cell.electrified {
    background: linear-gradient(45deg, #00ffff, #0080ff, #00ffff) !important;
    background-size: 200% 200% !important;
    animation: electricPulse 1s ease-in-out infinite alternate !important;
    box-shadow: 0 0 15px #00ffff, inset 0 0 15px rgba(0, 255, 255, 0.3) !important;
    border: 2px solid #00ffff !important;
}

.cell.electrified.disabled {
    background: linear-gradient(45deg, #ff8844, #ffaa66, #ff8844) !important;
    background-size: 200% 200% !important;
    animation: electricPulseDisabled 1s ease-in-out infinite alternate !important;
    box-shadow: 0 0 15px #ff8844, inset 0 0 15px rgba(255, 136, 68, 0.3) !important;
    border: 2px solid #ff8844 !important;
    cursor: not-allowed !important;
}

/* Animaciones eléctricas */
@keyframes electricPulse {
    0% {
        background-position: 0% 50%;
        box-shadow: 0 0 15px #00ffff, inset 0 0 15px rgba(0, 255, 255, 0.3);
    }
    100% {
        background-position: 100% 50%;
        box-shadow: 0 0 25px #00ffff, inset 0 0 25px rgba(0, 255, 255, 0.5);
    }
}

@keyframes electricPulseDisabled {
    0% {
        background-position: 0% 50%;
        box-shadow: 0 0 15px #ff8844, inset 0 0 15px rgba(255, 136, 68, 0.3);
    }
    100% {
        background-position: 100% 50%;
        box-shadow: 0 0 25px #ff8844, inset 0 0 25px rgba(255, 136, 68, 0.5);
    }
}

/* Advertencia de rayo */
.lightning-warning {
    position: relative !important;
    background: radial-gradient(circle, rgba(255, 255, 100, 0.9), rgba(255, 255, 0, 0.6), rgba(255, 200, 0, 0.3)) !important;
    border: 3px solid #ffff00 !important;
    border-radius: 8px !important;
    animation: lightningWarningPulse 0.4s ease-in-out infinite alternate !important;
    z-index: 999 !important;
    pointer-events: none !important;
    box-shadow: 
        0 0 20px rgba(255, 255, 0, 0.8),
        inset 0 0 10px rgba(255, 255, 255, 0.3) !important;
}

@keyframes lightningWarningPulse {
    0% {
        transform: scale(0.95);
        opacity: 0.7;
        box-shadow: 
            0 0 15px rgba(255, 255, 0, 0.6),
            inset 0 0 8px rgba(255, 255, 255, 0.2);
    }
    100% {
        transform: scale(1.05);
        opacity: 1;
        box-shadow: 
            0 0 30px rgba(255, 255, 0, 1),
            inset 0 0 15px rgba(255, 255, 255, 0.4);
    }
}

/* Advertencia de Teletransporte */
.teleport-warning {
    position: relative !important;
    background: radial-gradient(circle, rgba(173, 120, 255, 0.9), rgba(100, 50, 200, 0.6), rgba(50, 0, 130, 0.3)) !important;
    border: 3px solid #ad78ff !important;
    border-radius: 8px !important;
    animation: teleportWarningPulse 0.5s ease-in-out infinite alternate !important;
    z-index: 998 !important; /* Ligeramente por debajo del rayo */
    pointer-events: none !important;
    box-shadow: 
        0 0 20px rgba(173, 120, 255, 0.8),
        inset 0 0 10px rgba(230, 210, 255, 0.3) !important;
}

@keyframes teleportWarningPulse {
    0% {
        transform: scale(0.95);
        opacity: 0.7;
        box-shadow: 
            0 0 15px rgba(173, 120, 255, 0.6),
            inset 0 0 8px rgba(230, 210, 255, 0.2);
    }
    100% {
        transform: scale(1.05);
        opacity: 1;
        box-shadow: 
            0 0 30px rgba(173, 120, 255, 1),
            inset 0 0 15px rgba(230, 210, 255, 0.4);
    }
}

/* Efectos de descarga eléctrica */
.cell.electric-discharge {
    animation: electricDischarge 1s ease-out !important;
}

@keyframes electricDischarge {
    0% {
        background: #ffffff !important;
        box-shadow: 0 0 30px #00ffff !important;
        transform: scale(1);
    }
    25% {
        background: #00ffff !important;
        box-shadow: 0 0 50px #00ffff !important;
        transform: scale(1.1);
    }
    50% {
        background: #ffffff !important;
        box-shadow: 0 0 40px #ffff00 !important;
        transform: scale(1.05);
    }
    75% {
        background: #ffff00 !important;
        box-shadow: 0 0 30px #ffff00 !important;
        transform: scale(1.02);
    }
    100% {
        box-shadow: 0 0 10px #00ffff !important;
        transform: scale(1);
    }
}

/* Mensaje de bonus eléctrico */
.electric-bonus-message {
    font-family: 'Arial Black', Arial, sans-serif !important;
    font-size: 18px !important;
    font-weight: bold !important;
    color: #FFD700 !important;
    text-shadow: 
        0 0 10px #FFD700,
        0 0 20px #FFD700,
        0 0 30px #FFD700,
        2px 2px 4px rgba(0, 0, 0, 0.8) !important;
    z-index: 10000 !important;
    pointer-events: none !important;
    user-select: none !important;
}

@keyframes electricBonusFloat {
    0% {
        opacity: 1;
        transform: translate(-50%, -100%) scale(0.8);
    }
    20% {
        opacity: 1;
        transform: translate(-50%, -120%) scale(1.2);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -200%) scale(0.6);
    }
}

/* Efecto de tormenta eléctrica en pantalla */
.electric-storm-shake {
    animation: electricStormShake 0.8s ease-in-out !important;
}

@keyframes electricStormShake {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    10% { transform: translate(-2px, -1px) rotate(-0.5deg); }
    20% { transform: translate(2px, 1px) rotate(0.5deg); }
    30% { transform: translate(-1px, 2px) rotate(-0.3deg); }
    40% { transform: translate(1px, -2px) rotate(0.3deg); }
    50% { transform: translate(-2px, 1px) rotate(-0.4deg); }
    60% { transform: translate(2px, -1px) rotate(0.4deg); }
    70% { transform: translate(-1px, -2px) rotate(-0.2deg); }
    80% { transform: translate(1px, 2px) rotate(0.2deg); }
    90% { transform: translate(-1px, -1px) rotate(-0.1deg); }
}

/* Nubes de tormenta */
.storm-clouds {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(
        to bottom,
        rgba(30, 30, 50, 0.8) 0%,
        rgba(50, 50, 70, 0.6) 30%,
        transparent 60%
    ) !important;
    z-index: 500 !important;
    pointer-events: none !important;
    animation: stormCloudsGather 3s ease-in-out !important;
}

@keyframes stormCloudsGather {
    0% {
        opacity: 0;
        transform: translateY(-100%);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Efectos de tiempo para Nivel 5 */
#time-remaining-display {
    font-weight: bold;
    transition: color 0.3s ease;
}

#time-remaining-display.warning {
    color: #ffaa00 !important;
    animation: timeWarning 1s ease-in-out infinite alternate;
}

#time-remaining-display.critical {
    color: #ff4444 !important;
    font-weight: bold !important;
    animation: timeCritical 0.5s ease-in-out infinite alternate;
}

@keyframes timeWarning {
    0% { opacity: 0.7; }
    100% { opacity: 1; }
}

@keyframes timeCritical {
    0% { 
        opacity: 0.5; 
        transform: scale(1);
    }
    100% { 
        opacity: 1; 
        transform: scale(1.1);
    }
}

/* Partículas eléctricas */
.electric-particle {
    position: absolute !important;
    pointer-events: none !important;
    z-index: 2000 !important;
    border-radius: 50% !important;
    animation: electricParticleFloat 2s ease-out forwards !important;
}

@keyframes electricParticleFloat {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    100% {
        opacity: 0;
        transform: scale(0.3) translateY(-50px);
    }
}

/* Mejoras para el tablero durante tormentas eléctricas */
.board.electric-storm {
    box-shadow: 0 0 30px rgba(0, 255, 255, 0.5) !important;
    border: 2px solid rgba(0, 255, 255, 0.3) !important;
}

.game-container.lightning-active {
    filter: brightness(0.8) contrast(1.2) !important;
    transition: filter 0.5s ease-in-out !important;
}

.electrified-zone-indicator {
    position: absolute !important;
    background: rgba(255, 255, 0, 0.3) !important;
    border: 2px dashed #ffff00 !important;
    animation: electrifiedZonePulse 2s ease-in-out infinite !important;
    pointer-events: none !important;
    z-index: 998 !important;
}

@keyframes electrifiedZonePulse {
    0% {
        opacity: 0.3;
        transform: scale(0.95);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.05);
    }
    100% {
        opacity: 0.3;
        transform: scale(0.95);
    }
}

/* Nubes de tormenta mejoradas */
#storm-clouds-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(
        to bottom,
        rgba(30, 30, 50, 0.8) 0%,
        rgba(50, 50, 70, 0.6) 30%,
        rgba(70, 70, 90, 0.4) 50%,
        transparent 70%
    ) !important;
    z-index: 500 !important;
    pointer-events: none !important;
    animation: stormCloudsGather 2s ease-in-out !important;
    transition: opacity 1s ease-out !important;
    display: none !important;
}

/* Efecto de rumble de tormenta */
.storm-rumble {
    animation: stormRumble 2s ease-in-out !important;
}

@keyframes stormRumble {
    0%, 100% { transform: translate(0, 0); }
    10% { transform: translate(-0.5px, -0.5px); }
    20% { transform: translate(0.5px, 0.5px); }
    30% { transform: translate(-0.3px, 0.3px); }
    40% { transform: translate(0.3px, -0.3px); }
    50% { transform: translate(-0.4px, 0.4px); }
    60% { transform: translate(0.4px, -0.4px); }
    70% { transform: translate(-0.2px, -0.2px); }
    80% { transform: translate(0.2px, 0.2px); }
    90% { transform: translate(-0.1px, -0.1px); }
}

/* Efecto de destrucción por rayo */
.lightning-destruction {
    animation: lightningDestruction 0.5s ease-out !important;
    z-index: 1500 !important;
}

@keyframes lightningDestruction {
    0% {
        background: #ffffff !important;
        box-shadow: 0 0 40px #ff0000, 0 0 60px #ffff00 !important;
        transform: scale(1);
        opacity: 1;
    }
    25% {
        background: #ff4444 !important;
        box-shadow: 0 0 60px #ff0000, 0 0 80px #ffff00 !important;
        transform: scale(1.2);
        opacity: 0.9;
    }
    50% {
        background: #ffff00 !important;
        box-shadow: 0 0 50px #ffff00, 0 0 70px #ff8800 !important;
        transform: scale(1.1);
        opacity: 0.7;
    }
    75% {
        background: #ff8800 !important;
        box-shadow: 0 0 30px #ff8800, 0 0 50px #ff0000 !important;
        transform: scale(0.9);
        opacity: 0.4;
    }
    100% {
        background: transparent !important;
        box-shadow: 0 0 10px #ff0000 !important;
        transform: scale(0.8);
        opacity: 0;
    }
}

/* Efectos de tormenta eléctrica mejorados */
.lightning-active {
    position: relative;
}

.lightning-active::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
    pointer-events: none;
    z-index: 500;
    animation: lightningAmbient 2s ease-in-out infinite alternate;
}

@keyframes lightningAmbient {
    0% { opacity: 0.3; }
    100% { opacity: 0.7; }
}

.lightning-warning {
    position: relative;
    animation: lightningWarningPulse 0.5s ease-in-out infinite alternate !important;
    z-index: 1000 !important;
}

@keyframes lightningWarningPulse {
    0% {
        box-shadow: 0 0 20px rgba(255, 255, 0, 0.8), inset 0 0 20px rgba(255, 255, 0, 0.3);
        background-color: rgba(255, 255, 0, 0.2) !important;
    }
    100% {
        box-shadow: 0 0 40px rgba(255, 255, 0, 1), inset 0 0 30px rgba(255, 255, 0, 0.5);
        background-color: rgba(255, 255, 0, 0.4) !important;
    }
}

.lightning-shake {
    animation: lightningShakeEffect 0.5s ease-in-out;
}

@keyframes lightningShakeEffect {
    0%, 100% { transform: translateX(0); }
    10% { transform: translateX(-3px) translateY(-2px); }
    20% { transform: translateX(3px) translateY(2px); }
    30% { transform: translateX(-2px) translateY(-1px); }
    40% { transform: translateX(2px) translateY(1px); }
    50% { transform: translateX(-1px) translateY(-1px); }
    60% { transform: translateX(1px) translateY(1px); }
    70% { transform: translateX(-1px) translateY(0px); }
    80% { transform: translateX(1px) translateY(0px); }
    90% { transform: translateX(0px) translateY(-1px); }
}

.storm-rumble {
    animation: stormRumbleEffect 2s ease-in-out;
}

@keyframes stormRumbleEffect {
    0%, 100% { transform: translateY(0); }
    25% { transform: translateY(-1px); }
    50% { transform: translateY(1px); }
    75% { transform: translateY(-0.5px); }
}

/* Nubes de tormenta */
.storm-clouds {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        to bottom,
        rgba(20, 20, 40, 0.8) 0%,
        rgba(40, 40, 60, 0.6) 30%,
        rgba(60, 60, 80, 0.3) 60%,
        transparent 100%
    );
    pointer-events: none;
    z-index: 999;
    opacity: 0;
    transition: opacity 1s ease-in-out;
    display: none;
}

.storm-clouds::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 40%;
    background: 
        radial-gradient(ellipse 200px 100px at 20% 10%, rgba(30, 30, 50, 0.8) 0%, transparent 50%),
        radial-gradient(ellipse 300px 150px at 60% 5%, rgba(25, 25, 45, 0.9) 0%, transparent 50%),
        radial-gradient(ellipse 250px 120px at 80% 15%, rgba(35, 35, 55, 0.7) 0%, transparent 50%);
    animation: cloudDrift 8s ease-in-out infinite alternate;
}

@keyframes cloudDrift {
    0% { transform: translateX(-10px); }
    100% { transform: translateX(10px); }
}

/* Canvas de efectos eléctricos */
#lightningCanvas {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    pointer-events: none !important;
    z-index: 1500 !important;
} 